rm(list=ls())

riverdata = read.csv("data/mass/mass1_327.csv")
riverdata[,1] = as.POSIXct(riverdata[,1],format="%Y-%m-%d %H:%M:%S",tz="GMT")
riverdata[,4] = riverdata[,4]+1.039

start.time = as.POSIXct("2009-01-01 00:00:00",format="%Y-%m-%d %H:%M:%S",tz="GMT")
end.time = as.POSIXct("2010-12-31 23:00:00",format="%Y-%m-%d %H:%M:%S",tz="GMT")

selected.time = which(riverdata[,1]>=start.time &
                      riverdata[,1]<=end.time)                      


##times = seq(0,438,1)*3600*120+as.POSIXct("2010-01-01 00:00:00",format="%Y-%m-%d %H:%M:%S",tz="GMT")

time.bar =  as.POSIXct("2009-01-01 00:00:00",format="%Y-%m-%d %H:%M:%S",tz="GMT")
time.bar = time.bar+seq(0,3600*24*10*36,3600*24*10)
fname = paste("figures/2009_river.pdf",sep="")
pdf(file=fname,width=10,height=5)
par(mar=c(2,4.5,1,2))
plot(riverdata[selected.time,1],riverdata[selected.time,4],
     type="l",col="blue",ylim=c(104,107),
     ##     xlim = range(c(start.time,end.time)),
     axes=FALSE,xlab=NA,ylab=NA,lwd=2,
##     main = paste(format(time.bar,format="%Y-%m-%d %H:%M:%S",tz="GMT")),cex.main=2
     )

axis(2,at=seq(0,200,1),mgp=c(5,0.7,0),cex.axis=1.5,las=1)
mtext("River level (m)",2,line=3,cex=1.5)
axis.POSIXct(1,at=seq(as.Date("2008-01-01",tz="GMT"),
                      to=as.Date("2016-01-01",tz="GMT"),by="quarter"),
             format="%m/%Y",mgp=c(5,1,0),cex.axis=1.5)
## for (itime in 1:length(time.bar))
## {
##     lines(c(time.bar[itime],time.bar[itime]),c(0,200),lwd=4,col='red')
## }    


time.bar =  as.POSIXct("2009-01-01 00:00:00",format="%Y-%m-%d %H:%M:%S",tz="GMT")
time.bar = time.bar+3600*24*10*c(4,11,15,25)


for (itime in 1:length(time.bar))
{
    lines(c(time.bar[itime],time.bar[itime]),c(0,200),lwd=4,col='red')
}    

box()
dev.off()


